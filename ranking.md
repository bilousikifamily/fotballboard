# Модуль ранжування фракцій

Розташування: `web/src/features/factionRanking.ts`

## Відповідальність
- Рендер таблиці фракційного лідерборда (`renderLeaderboardList`) та обробка пустого/помилкового стану (`renderUsersError`).
- Рендер секції "Топ-5 депутатів фракції" (`renderFactionMembersSection`) та її рядків (`renderFactionMembersRows`).
- Підтримка кешів для призових позицій та ранжування фракцій (`updateFactionRankCache`, `getFactionPrizeSrc`).

## Потік даних
- `loadLeaderboard` викликає `renderLeaderboardList`, щоб побудувати таблицю, і `updateFactionRankCache`, щоб зберегти ранги.
- `loadFactionMembers` викликає `renderFactionMembersRows`, щоби показати топ-5 депутатів із використанням кешованого рангу фракції.

## Правила ранжування
- Ідентифікатори фракцій нормалізуються (trim + lower case) перед зведенням/кешуванням.
- Лідерборд зводить користувачів по фракціях, лишаючи перший запис для кожної.
- Ранг зростає лише при зміні кількості очок, тож однакові очки отримують однаковий ранг.
- Іконки призів для позицій 1-5 визначаються загальною мапою призів.

## Банкноти в таблицях
- Загальна таблиця і топ-5 депутатів користуються однією мапою банківок (`FACTION_PRIZE_MAP`) з іконками для позицій 1-5.
- При рендері лідерборда (`renderLeaderboardList`) кожна унікальна фракція зберігає призову іконку в `factionPrizeMap`, коли вона отримує ранг до 5, щоб потім віддавати правильну банківку для цієї фракції (`getFactionPrizeSrc`).
- Бекенд додає `faction_rank` у відповідь `GET /api/faction-members` лише для фракцій із місцями 1-5, що гарантує, що топ-5 депутатів бачать банківку лише в цих випадках.
- Топ-5 депутатів (`renderFactionMembersRows`) підставляє банківку тільки якщо фракція в загальній таблиці посідає місце 1-5: rank 1 → `500.png`, rank 2 → `200.png`, rank 3 → `100.png`, rank 4 → `50.png`, rank 5 → `20.png`. Якщо фракція 6+ — зображення банківки не з’являється для топ-5.

## Правила топ-5 депутатів
- Список показує перших 5 членів фракції згідно з порядком, який надає сервер.
- Якщо поточний користувач поза топ-5, він додається в кінець (макс. 6 записів).
- Глобальний приз фракції (від кешованого рангу) переважає локальні іконки призів, якщо доступний.
